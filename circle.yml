## https://circleci.com/docs/1.0/build-image-macos/
## Customize the test machine
machine:
  xcode:
    xcode: 9.1.0

dependencies:
  pre:
    - brew update
    - brew install qt5 gsl lzo jpeg libpng libsndfile tree
    - echo 'export QTDIR="/usr/local/opt/qt5"' >> ~/.bash_profile
    - echo 'export PATH="$QTDIR/bin:$PATH"' >> ~/.bash_profile
    - echo 'export LDFLAGS="-L$QTDIR/lib $LDFLAGS"' >> ~/.bash_profile
    - echo 'export CPPFLAGS="-I$QTDIR/include $CPPFLAGS"' >> ~/.bash_profile

compile:
  override:
    - qmake -spec macx-xcode mandelbulber2/qmake/mandelbulber.pro
#    - qmake -project
    - qmake -o makefile mandelbulber2/qmake/mandelbulber.pro
#    - cmake --verbose=1 -DUSE_GAMEPAD=1 -G "Xcode" mandelbulber2/cmake/
#    - xcodebuild -project mandelbulber2.xcodeproj
#    - macdeployqt mandelbulber2.app -dmg
    - make -j3
    - tree .

test:
  override:
    - "true"

general:
  artifacts:
    - circle.yml
